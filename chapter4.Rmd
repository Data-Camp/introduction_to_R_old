---
title_meta  : Chapter 4
title       : Factors
description : Very often, data falls into a limited number of categories. For example, sex can often be limited to either male or female. In R, categorical data is stored in factors. Given the importance of these factors in data analysis, you should start learning how to create, subset and compare them now!

---
## What's a factor and why would you use it?

```yaml
type: NormalExercise
xp: 100
skills: 1
key: 05273321916d99bb9c0deadf75c6834d25a47244
```

The `numeric` vectors that you worked with in the previous chapters are used to store **continuous** variables. For continuous variables, it makes sense to talk about ranges of values, and you can compare values: for example you can talk about `x` being less than `y`. You also have an essentially infinite number of possible values.

By contrast, if a variable should be limited to a **finite number of values**, it is called a **categorical** variable. Categorical variables are stored using the [`factor()`](http://www.rdocumentation.org/packages/base/topics/factor) data type, which will be discussed in the next few exercises.

A good example of a categorical variable is sex. In many circumstances you can limit the sex categories to "Male" or "Female". (Sometimes you may need different categories. For example, you may need to consider chromosomal variation or hermaphroditic animals or intersex people, but you will always have a finite number of categories.)

`@instructions`

A factor created from a character vector of animals has been pre-defined as `factor_animals_vector`.

Print the factor and examine the output.

`@hint`

Type the name of the variable, `factor_animals_vector` to print it.

`@pre_exercise_code`
```{r}
factor_animals_vector <- factor(c(
  "Elephant", "Giraffe", "Donkey", "Giraffe", 
  "Horse", "Donkey", "Donkey", "Horse"
))
```

`@sample_code`
```{r}
# A factor created from a vector of animals has been pre-defined
factor_animals_vector
```

`@solution`
```{r}
# A factor created from a vector of animals has been pre-defined
factor_animals_vector
```

`@sct`
```{r}
predef_msg <- "Do not change the definition of pre-defined `factor_animals_vector`!"
test_object("factor_animals_vector", undefined_msg = predef_msg, incorrect_msg = predef_msg)
success_msg("Good job! Ready to start? Continue to the next exercise!")
```


---
## What's a factor and why would you use it? (2)

```yaml
type: NormalExercise
xp: 100
skills: 1
key: 6cc21c842b075347926bb1b244782213df32e370
```

To create vectors of categorical variables in R, you make use of the function [`factor()`](http://www.rdocumentation.org/packages/base/functions/factor). This takes a character vector as an input, and it should have a limited number of distinct values. For example, `sex_vector` contains the sex of 5 different individuals:

```r
sex_vector <- c("Male", "Female", "Female", "Male", "Male")
```

It is clear that there are two categories here: "Male" and "Female". In R terminology, these are called **factor levels**.
The function [`factor()`](http://www.rdocumentation.org/packages/base/functions/factor) will encode the vector as a factor:

```{r}
factor_sex_vector <- factor(sex_vector)
```

`@instructions`
- Convert the character vector `sex_vector` to a factor with `factor()` and assign the result to `factor_sex_vector`
- Print out `factor_sex_vector` and assert that R prints out the factor levels below the actual values.

`@hint`
Simply use the function [`factor()`](http://www.rdocumentation.org/packages/base/functions/factor) on `sex_vector`. Have a look at the assignment, the answer is already there somewhere...

`@pre_exercise_code`
```{r}
# no pec
```

`@sample_code`
```{r}
# Sex vector
sex_vector <- c("Male", "Female", "Female", "Male", "Male")

# Convert sex_vector to a factor
factor_gender_vector <- ___(___)

# Print out factor_gender_vector
___
```

`@solution`
```{r}
# Sex vector
sex_vector <- c("Male", "Female", "Female", "Male", "Male")

# Convert sex_vector to a factor
factor_sex_vector <- factor(sex_vector)

# Print out factor_sex_vector
factor_sex_vector
```

`@sct`
```{r}
test_object("factor_sex_vector",
            incorrect_msg = "Did you assign the factor of `sex_vector` to `factor_sex_vector`?")
test_output_contains("factor_sex_vector", incorrect_msg = "Don't forget to print out `factor_sex_vector`!")
success_msg("Great! If you want to find out more about the `factor()` function, do not hesitate to type `?factor` in the console. This will open up a help page. Continue to the next exercise.");
```


---
## What's a factor and why would you use it? (3)

```yaml
type: NormalExercise
xp: 100
skills: 1
key: 5bd4f50afc2c2dbc881e16b8ca94ca56960dff42
```

There are two types of categorical variables: a **nominal categorical variable** and an **ordinal categorical variable**.

A nominal variable is a categorical variable without an implied order. This means that it is impossible to say that 'one is worth more than the other'. For example, think of the categorical variable `animals_vector` with the categories `"Elephant"`, `"Giraffe"`, `"Donkey"` and `"Horse"`. Here, it is impossible to say that one is greater than or less than the other. (Note that some of you might disagree ;-)).

In contrast, ordinal variables do have a natural ordering. Consider for example the categorical variable `temperature_vector` with the categories: `"Low"`, `"Medium"` and `"High"`. Here it is obvious that `"Medium"` is greater than `"Low"`, and `"High"` is greater than `"Medium"`.

You've already seen that nominal categorical variables are create with [`factor()`](http://www.rdocumentation.org/packages/base/functions/factor). To create ordinal categorical variables, you use [`ordered()`](http://www.rdocumentation.org/packages/base/functions/factor).

In R terminology, "factor" usually refers to an unordered factor, that is, a nominal categorical variable. Ordinal categorical variables are called "ordered factors".

`@instructions`

* Create an unordered factor from `animals_vector`, assigning the result to `factor_animals_vector`.
* Create an ordered factor from `temperature_vector` assigning the result to `factor_temperature_vector`.
* Notice the trick of wrapping an assignment in parentheses, `( )`, to assign and print in one line!

`@hint`

* Call `factor()` with `animals_vector` to create the unordered factor.
* Call `ordered()` with `temperature_vector` to create the ordered factor.

`@pre_exercise_code`
```{r}
# no pec
```

`@sample_code`
```{r}
# Animals
animals_vector <- c(
  "Elephant", "Giraffe", "Donkey", "Giraffe", 
  "Horse", "Donkey", "Donkey", "Horse"
)
(factor_animals_vector <- ___(___))

 # Temperature
temperature_vector <- c("High", "Low", "High", "Low", "Medium")
(factor_temperature_vector <- ___(___, levels = c("Low", "Medium", "High")))
```

`@solution`
```{r}
# Animals
animals_vector <- c(
  "Elephant", "Giraffe", "Donkey", "Giraffe", 
  "Horse", "Donkey", "Donkey", "Horse"
)
(factor_animals_vector <- factor(animals_vector))

 # Temperature
temperature_vector <- c("High", "Low", "High", "Low", "Medium")
(factor_temperature_vector <- ordered(temperature_vector, levels = c("Low", "Medium", "High")))
```

`@sct`
```{r}
prespec_msg <- "Do not change anything about the pre-specified variables `animals_vector` and `temperature_vector`!"
test_object("animals_vector", undefined_msg = prespec_msg, incorrect_msg = prespec_msg)
test_object("temperature_vector", undefined_msg = prespec_msg, incorrect_msg = prespec_msg)
animals_msg <- "Did you call `factor()` on `animals_vector`?"
test_object("factor_animals_vector", undefined_msg = animals_msg, incorrect_msg = animals_msg)
test_output_contains("factor_animals_vector")
temperature_msg <- "Did you call `ordered()` on `temperature_vector`?"
test_object("factor_temperature_vector", undefined_msg = temperature_msg, incorrect_msg = temperature_msg)
test_output_contains("factor_temperature_vector")
success_msg("Your code is of the highest order! You can also create ordered factors by calling `factor()` with `ordered = TRUE`.")
```


---
## Factor levels

```yaml
type: NormalExercise
xp: 100
skills: 1
key: 1aa698978d32d1a0befa4700d7da85a648e1d69e
```

The categories of a factor are known as **levels**. You can access them using the [`levels()`](http://www.rdocumentation.org/packages/base/functions/levels) function. By default, [`factor()`](http://www.rdocumentation.org/packages/base/functions/factor) assigns the levels in alphabetical order.

```
animals_vector <- c(
  "Elephant", "Giraffe", "Donkey", "Giraffe", 
  "Horse", "Donkey", "Donkey", "Horse"
)
factor_animals_vector <- factor(animals_vector)
levels(factor_animals_vector)
## [1] "Donkey"   "Elephant" "Giraffe"  "Horse"
```

If you want to control the order of the levels, you can pass the `levels` argument to `factor()`. For example, to order the levels by typical height of animal, you can write

```
factor_animals_vector2 <- factor(animals_vector, levels = c("Donkey", "Horse", "Elephant", "Giraffe"))
levels(factor_animals_vector2)
## [1] "Donkey"   "Horse"    "Elephant" "Giraffe"
```

You are given the results of a survey to analyze. One of the questions asked the sex of the respondent.

`@instructions`

`sex_vector` has been pre-defined in your workspace.

* Create an unordered factor from `sex_vector` and store it in `factor_sex_vector_fm`.
* Print the levels of this factor, observing that they are alphabetically sorted.
* Recreate the factor, using the `levels` argument to `factor()` to specify `"Male"` as the first level and `"Female"` as the second level. Store this in `factor_sex_vector_mf`.
* Print the levels of this factor, observing that this time `"Male"` comes first.

`@hint`

* Call `factor()` with `sex_vector` to create the first factor.
* Use `levels(x)` to get the levels of a factor named `x`.
* Call `factor()` with `sex_vector` and `levels = c("Male", "Female")` to enforce `"Male"` being the first level.

`@pre_exercise_code`
```{r}
sex_vector <- c("Male", "Female", "Female", "Male", "Male")
```

`@sample_code`
```{r}
# sex_vector has been pre-defined
sex_vector
 
# Create an unordered factor of sexes
factor_sex_vector_fm <- ___(___)
 
# Print the levels of factor_sex_vector_fm
___(factor_sex_vector_fm) 

# Recreate the factor with "Male" as the first factor level
factor_sex_vector_mf <- ___(___, levels = ___)

# Print the levels of factor_sex_vector_mf
___(___)
```

`@solution`
```{r}
# sex_vector has been pre-defined
sex_vector

# Create an unordered factor of sexes
factor_sex_vector_fm <- factor(sex_vector)

# Print the levels of factor_sex_vector_fm
levels(factor_sex_vector_fm) 
 
# Recreate the factor with "Male" as the first factor level
factor_sex_vector_mf <- factor(sex_vector, levels = c("Male", "Female"))
 
# Print the levels of factor_sex_vector_mf
levels(factor_sex_vector_mf)
```

`@sct`
```{r}
predef_msg <- "Do not change the definition of pre-defined `sex_vector`!"
test_object("factor_sex_vector_fm", undefined_msg = predef_msg, incorrect_msg = predef_msg)
test_output_contains("levels(factor_sex_vector_fm)")
test_object("factor_sex_vector_mf", undefined_msg = predef_msg, incorrect_msg = predef_msg)
test_output_contains("levels(factor_sex_vector_mf)")
success_msg("You've leveled up! The `levels()` function and the `level` argument to `factor()` let you control the levels.")
```


---
## Summarizing a factor

```yaml
type: NormalExercise
xp: 100
skills: 1
key: a549f13c0644ccc89cd39a10aa48706754637ed0
```

It is often useful to count how many times each level occurs in a factor.  To do this, you can use the [`table()`](http://www.rdocumentation.org/packages/base/functions/table) function. ([`summary()`](http://www.rdocumentation.org/packages/base/functions/summary) performs a similar task for factors.)

```
animals_vector <- c(
  "Elephant", "Giraffe", "Donkey", "Giraffe", 
  "Horse", "Donkey", "Donkey", "Horse"
)
factor_animals_vector <- factor(animals_vector)
table(factor_animals_vector)
## factor_animals_vector
##   Donkey Elephant  Giraffe    Horse 
##        3        1        2        2
```

Going back to our survey, you would like to know how many `"Male"` responses you have in your study, and how many `"Female"` responses.

`@instructions`

`factor_sex_vector` has been pre-defined in your workspace.

* Use `table()` to count the number of `Male`s and `Female`s in `factor_sex_vector`.
* Do the same thing again, this time using `summary()`.

`@hint`

* Call [`table()`](http://www.rdocumentation.org/packages/base/functions/table), passing `factor_sex_vector`.
* Then call [`summary()`](http://www.rdocumentation.org/packages/base/functions/summary) in the same way.


`@pre_exercise_code`
```{r}
factor_sex_vector <- factor(c("Male", "Female", "Female", "Male", "Male"))
```

`@sample_code`
```{r}
# factor_sex_vector has been pre-defined
factor_sex_vector

# Count the number of males and females in `factor_sex_vector`
___(___)
 
# Same again, using summary()
___(___)
```

`@solution`
```{r}
# factor_sex_vector has been pre-defined
factor_sex_vector

# Count the number of males and females in `factor_sex_vector`
table(factor_sex_vector)
 
# Same again, using summary()
summary(factor_sex_vector)
```

`@sct`
```{r}
predef_msg <- "Do not change the definition of pre-defined `sex_vector`!"
test_object("factor_sex_vector", undefined_msg = predef_msg, incorrect_msg = predef_msg)
test_output_contains("table(factor_sex_vector)")
test_output_contains("summary(factor_sex_vector)")
success_msg("Nice! Have a look at the output. The fact that `\"Male\"` and `\"Female\"` were specified as factor levels in `factor_sex_vector` enables R to show the number of elements for each category.")
```


---
## Battle of the sexes

```yaml
type: NormalExercise
xp: 100
skills: 1
key: 90ecc160d1ebf2f75bf53f9c3843fc1632bdd0a5
```

Previously you learned that for ordered factors, you can talk about levels being greater than or less than each other. For example, recall the temperatures data from a few exercises back.

```r
temperature_vector <- c("High", "Low", "High", "Low", "Medium")
factor_temperature_vector <- ordered(
  temperature_vector, 
  levels = c("Low", "Medium", "High")
)
factor_temperature_vector <= "Medium"
## [1] FALSE  TRUE FALSE  TRUE  TRUE
```

You might wonder what happens when you try to compare elements of an unordered factor.  In `factor_sex_vector` you have a factor with two levels: `"Male"` and `"Female"`. But how does R value these relatively to each other? In other words, who does R think is greater, males or females?

`@instructions`

`factor_sex_vector` has been pre-defined in your workspace. The first value of `factor_sex_vector` is a male, and the second value is a female.

* Select the first value of `factor_sex_vector` and assign the results to `male`.
* Select the second value of `factor_sex_vector` and assign the results to `female`.
* Compare the two genders, testing if `male` is greater than (`>`) `female`.

`@hint`

* Use `factor_sex_vector[i]` to select the `i`th element of `factor_sex_vector`.
* Use `male > female` to compare the sexes.

`@pre_exercise_code`
```{r}
factor_sex_vector <- factor(c("Male", "Female", "Female", "Male", "Male"))
```

`@sample_code`
```{r}
# factor_sex_vector has been pre-defined
factor_sex_vector

# Male
male <- factor_sex_vector[1]

# Female
female <- ___

# Battle of the sexes: is male greater than female?
male ___ female
```

`@solution`
```{r}
# factor_sex_vector has been pre-defined
factor_sex_vector

# Male
male <- factor_sex_vector[1]

# Female
female <- factor_sex_vector[2]

# Battle of the sexes: is male greater than female?
male > female
```

`@sct`
```{r}
predef_msg <- "Do not change the definition of pre-defined `sex_vector`!"
test_object("factor_sex_vector", undefined_msg = predef_msg, incorrect_msg = predef_msg)
male_msg <- "Do not change the code to define `male`."
test_object("male", undefined_msg = male_msg, incorrect_msg = male_msg)
female_msg <- "Define `female` as `factor_sex_vector[2]`."
test_object("female", undefined_msg = female_msg, incorrect_msg = female_msg)
test_output_contains("male > female")
success_msg("Phew, it seems that R is not a sexist language.")
```


---
## Ordered factors

```yaml
type: NormalExercise
xp: 100
skills: 1
key: 9ab0928916bf84ab225713a9a1ce40d9e322c6a0
```

In the previous exercise, since `"Male"` and `"Female"` were unordered (or nominal) factor levels, R returned a warning message, telling you that the greater than operator was not meaningful. But this is not always the case! Sometimes you will also deal with factors that do have a natural ordering between their categories.

Let us say that you are leading a research team of five data analysts and that you want to evaluate their performance. To do this, you track their speed, evaluate each analyst as `"slow"`, `"medium"` or `"fast"`, and save the results in `speed_vector`.

`@instructions`

* Use [`c()`](https://www.rdocumentation.org/packages/base/topics/c) to create a character vector, named `speed_vector`, with 5 entries, one for each analyst. Each entry should be either `"slow"`, `"medium"`, or `"fast"`. Use the list below:

    - Analyst 1 is medium,
    - Analyst 2 is slow,
    - Analyst 3 is slow,
    - Analyst 4 is medium and
    - Analyst 5 is fast.

* Use [`ordered()`](https://www.rdocumentation.org/packages/base/topics/factor) to create an ordered factor from `speed_vector` and assign it to `factor_speed_vector`. The factor levels should be `"slow"`, `"medium"`, and `"fast"`.

`@hint`

* Use `c()` to create a character vector.
* Each of the elements of `speed_vector` should be `"slow"`, `"medium"`, or `"fast"`.
* Use `ordered()` to create an ordered factor.
* The `levels` of the factor should be a character vector of `"slow"`, `"medium"`, and `"fast"`.

`@pre_exercise_code`
```{r}
# no pec
```

`@sample_code`
```{r}
# Create speed_vector
speed_vector <- c("medium", ___, ___, ___, ___)
 
# Convert it to a factor
factor_speed_vector <- ___(___, levels = c("slow", "medium", "fast"))
```

`@solution`
```{r}
# Create speed_vector
speed_vector <- c("medium", "slow", "slow", "medium", "fast")
 
# Convert it to a factor
factor_speed_vector <- ordered(speed_vector, levels = c("slow", "medium", "fast"))
```

`@sct`
```{r}
speed_vec_msg <- "`speed_vector` should be a vector with 5 entries, one for each analyst's speed rating. Don't use capital letters; R is case sensitive!"
test_object("speed_vector", undefined_msg = speed_vec_msg, incorrect_msg = speed_vec_msg)
factor_speed_vec_msg <- 'Did you call `ordered()`, passing `speed_vector`, and `levels = c("slow", "medium", "fast")`?'
test_object("factor_speed_vector", undefined_msg = factor_speed_vec_msg, incorrect_msg = factor_speed_vec_msg)
success_msg("A job well done! Continue to the next exercise.")
```


---
## Ordered factors (2)

```yaml
type: NormalExercise
xp: 100
skills: 1
key: 279077d10248ce03d5f972939ef8576430a16683
```

So far, you've created ordered factors using the [`ordered()`](http://www.rdocumentation.org/packages/base/functions/factor) function. There is another way. You can also call the [`factor()`](http://www.rdocumentation.org/packages/base/functions/factor) function and pass the argument `ordered = TRUE`.

```r
sex_vector <- c("Male", "Female", "Female", "Male", "Male")
factor(sex_vector, ordered = TRUE)
```

As before, you can optionally pass the argument `levels` to set the order of the factor levels.

`@instructions`

`speed_vector` has been pre-defined in your workspace.

From `speed_vector`, create an ordered factor vector: `factor_speed_vector`. Set `ordered` to `TRUE`, and set `levels` to `c("slow", "medium", "fast")`.

`@hint`

- Use the function [`factor()`](http://www.rdocumentation.org/packages/base/functions/factor) to create `factor_speed_vector` based on `speed_vector`. 
- The argument `ordered` should be set to `TRUE` since there is a natural ordering. 
- Don't change the argument `levels = c("slow", "medium", "fast"")`.

`@pre_exercise_code`
```{r}
speed_vector <- c("medium", "slow", "slow", "medium", "fast")
```

`@sample_code`
```{r}
# Convert speed_vector to ordered factor vector
factor_speed_vector <- ___(___, levels = c("slow", "medium", "fast"), ___ = ___)

# Print factor_speed_vector
factor_speed_vector
```

`@solution`
```{r}
# Convert speed_vector to ordered factor vector
factor_speed_vector <- factor(speed_vector, levels = c("slow", "medium", "fast"), ordered = TRUE)

# Print factor_speed_vector
factor_speed_vector
```

`@sct`
```{r}
predef_msg <- "Do not change the definition of pre-defined `speed_vector`!"
test_object("speed_vector", undefined_msg = predef_msg, incorrect_msg = predef_msg)
test_function("factor", args = c("x", "levels", "ordered"),
              incorrect_msg = c("The first argument you pass to `factor()` should be `speed_vector`.",
                                "Make sure to set `levels = c(\"slow\", \"fast\", \"insane\")` inside your call of `factor()`.",
                                "Make sure to set `ordered = TRUE` inside your call of `factor()`."))
test_object("factor_speed_vector", eq_condition = "equal",
            incorrect_msg = "There's something wrong with `factor_speed_vector`; make sure to only pass `speed_vector`, `levels = c(\"slow\", \"fast\", \"insane\")`, and `ordered = TRUE` inside your call to `factor()`.")
success_msg("Great! Have a look at the console. It is now indicated that the levels indeed have an order associated, with the `<` sign. Continue to the next exercise.")
```


---
## Comparing ordered factors

```yaml
type: NormalExercise
xp: 100
skills: 1
key: db16e69805625bcfde227743a8cbc985f8482a37
```

Having a bad day at work, 'data analyst number two' enters your office and starts complaining that 'data analyst number five' is slowing down the entire project. Since you know that 'data analyst number two' has the reputation of being a smarty-pants, you first decide to check if his statement is true.

The fact that `factor_speed_vector` is now ordered enables us to compare different elements (the data analysts in this case). You can simply do this by using the well-known operators.

`@instructions`

`factor_speed_vector` has been pre-defined in your workspace.

- Use `[2]` to select from `factor_speed_vector` the factor value for the second data analyst. Store it as `da2`.
- Use `[5]` to select the `factor_speed_vector` factor value for the fifth data analyst. Store it as `da5`.
- Check if `da2` is greater than `da5`; simply print out the result. Remember that you can use the `>` operator to check whether one element is greater than the other.

`@hint`
- To select the factor value for the third data analyst, you'd need `factor_speed_vector[3]`.
- To compare two values, you can use `>`. For example: `da3 > da4`.

`@pre_exercise_code`
```{r}
factor_speed_vector <- ordered(
  c("medium", "slow", "slow", "medium", "fast"),
  levels = c("slow", "medium", "fast")
)
```

`@sample_code`
```{r}
# factor_speed_vector has been pre-defined for you
factor_speed_vector

# Factor value for second data analyst
da2 <- factor_speed_vector[___]

# Factor value for fifth data analyst
da5 <- ___

# Is data analyst 2 faster than data analyst 5?
___
```

`@solution`
```{r}
# factor_speed_vector has been pre-defined for you
factor_speed_vector

# Factor value for second data analyst
da2 <- factor_speed_vector[2]

# Factor value for fifth data analyst
da5 <- factor_speed_vector[5]

# Is data analyst 2 faster data analyst 5?
da2 > da5
```

`@sct`
```{r}
predef_msg <- "Do not change the definition of pre-defined `factor_speed_vector`!"
test_object("factor_speed_vector", undefined_msg = predef_msg, incorrect_msg = predef_msg)

msg <- "Have you correctly selected the factor value for the %s data analyst? You can use `factor_speed_vector[%s]`."
test_object("da2", eq_condition = "equal", incorrect_msg = sprintf(msg, "second", "2"))
test_object("da5", eq_condition = "equal", incorrect_msg = sprintf(msg, "fifth", "5"))
test_output_contains("da2 > da5", incorrect_msg = "Have you correctly compared `da2` and `da5`? You can use the `>`. Simply print out the result.")

success_msg("Bellissimo! What does the result tell you? Data analyst two is complaining about the data analyst five while in fact they are the one slowing everything down! This concludes the chapter on factors. With a solid basis in vectors, matrices and factors, you're ready to dive into the wonderful world of data frames, a very important data structure in R!")
```



